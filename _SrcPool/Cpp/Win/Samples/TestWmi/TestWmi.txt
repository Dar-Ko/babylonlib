$RCSfile: TestWmi.txt,v $: developer's note
$Revision: 1.3 $ $Date: 2011/10/25 21:10:41 $
$Author: ddarko $

Samples and test suites for the Windows Management Instrumentation (WMI).

Copyright: Darko Kolakovic
2010-01-05 Darko Kolakovic

Windows Management Instrumentation (WMI) is a set of specifications from Microsoft for consolidating the management of devices and applications in a network from Windows computing systems. WMI is installed on all computers with Windows Millennium Edition (Me), Windows 2000, Windows XP, or Windows Server 2003. It can be downloaded for computers using Windows 98 or Windows NT 4.0. WMI is the Microsoft implementation of Web Based Enterprise Management (WBEM), which is built on the Common Information Model (CIM), a computer industry standard for defining device and application characteristics so that system administrators and management programs can control devices and applications from multiple manufacturers or sources in the same way.
(http://searchwindowsserver.techtarget.com/sDefinition/0,,sid68_gci1065292,00.html)

To view Hidden Devices in the device manager:
  1.  Add environment variable SET DEVMGR_SHOW_NONPRESENT_DEVICES=1
  2.  set Computer Management | Device Manager | View Menu | Show Hidden Devices

See also: Creating a WMI Application Using C++ (http://msdn.microsoft.com/en-us/library/aa389762%28VS.85%29.aspx)

    CONSOLE APPLICATION : TestWmi Project Overview
========================================================================

\	TestWmi.vcproj Microsoft Developer Studio .Net Project (VcProj) file is a generated build file, format version 8.0 (MSVC8 2005).	Win32

Microsoft Visual Studio C++ 2008 v9.0
======================================
- ATL Server support has been removed from this version of Visual Studio. In case your ATL Project uses any ATL Server functionality, your project may not build. Please consult the MSDN documentation for a list of alternatives. 
- Web deployment to the local IIS server is no longer supported. The Web Deployment build tool has been removed from your project settings. 
- This application has been updated to include settings related to the User Account Control (UAC) feature of Windows Vista. By default, when run on Windows Vista with UAC enabled, this application is marked to run with the same privileges as the process that launched it. This marking also disables the application from running with virtualization. You can change UAC related settings from the Property Pages of the project. 


Partial Assembly failed for Microsoft.VC80 CRT
---------------------------------------------------
While running the debug (or release) version of the application, following message apears:
  "This application has failed to start because the application configuration is incorrect.
    Reinstalling the application may fix this problem."

Event log have next entries:
  "Resolve Partial Assembly failed for Microsoft.VC80.DebugCRT.
   Reference error message: The referenced assembly is not installed on your system."
and
  "Generate Activation Context failed for \\?\C:\ISAPI\Content Control\IIS_Content_Control.dll.
   Reference error message: The referenced assembly is not installed on your system."

When Visual Studio is installed, these libraries are place in the Windows Side-By-Side (SxS)
assembly cache, meaning they will always be found by an application when run on the machine
with MSVC installed.
The merge modules (.msm) should also be doing the same thing. 
It is possible that the merge modules are for an older version of the CRT/MFC runtimes.
If this is the case, rebuild application with current version of CRT libraries.

Solution:
  - Debug build
    1. Install Visual Studio 2005 on the target machine. 
       This will install the necessary MSVCR80D.DLL etc to the WinSxS folder or
    2. copy the contents (including manifest) of the
        %PROGFILES%\microsoft visual studio 8\vc\redist\Debug_NonRedist\x86\Microsoft.VC80.DebugCRT
       and
        %PROGFILES%\microsoft visual studio 8\vc\redist\Debug_NonRedist\x86\Microsoft.VC80.DebugMFC
       folders to the same folder as your built DLL.
    3. Create a small setup that includes microsoft_vc80_debugcrt_x86.msm MSM merge module from
       "%PROGFILES%\common files\merge modules\" directory and run created setup on the target machine.
       Ref.: http://msdn2.microsoft.com/en-us/library/ms235285(en-US,VS.80).aspx

  - Release build
    1. Install MSVC80 CRT assembly on the target machine by executing vcredist_x86.exe from
        %PROGFILES%Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages\vcredist_x86\
    2. Copy the contents of 
        %PROGFILES%\Microsoft Visual Studio 8\VC\redist\x86\Microsoft.VC80.MFC 
       to the same folder as your DLL.
    3. Create a small setup that includes Microsoft_VC80_MFC_x86.msm MSM merge module from
       "%PROGFILES%\common files\merge modules\" directory and run created setup on the target machine.
       To create setup project:
        a. open Visual Studio and created a Regular Setup Project
        b. add the required Merge Modules (.msm) from "%PROGFILES%\common files\merge modules\" 
           to the project
        c. buid the deployment project
