<!doctype html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-CA" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0" />
<meta name="ProgId" content="FrontPage.Editor.Document" />
<title>Test Component Object Model (COM) Container</title>
<!-- Group=Examples -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="en-ca" />
<meta name="Workfile" content="$Workfile: TestComContainer.htm$: documentation" />
<meta name="Revision" content="$Revision: 2$ $Date: 2007-02-27 18:33:59$" />
<meta name="Editor" content="$Author: Darko Kolakovic$" />
<meta name="Copyright" content="&copy; CommonSoft Inc, 1985-2032." />
<meta name="author" content="Darko Kolakovi&#263;" />
<meta name="robots" content="index" />
<meta name="keywords" content="Win32, test, COM, ActiveX" />
<meta name="description" content="Test Component Object Model (COM) Container" />
<link rel="stylesheet" type="text/css" media="all" href="../../../../../../Doc/Res/KDocument.css" />
<link rel="icon" type="image/ico" href="../../../../../../Doc/Res/icoWin32.ico" />
<!-- Install Microsoft Script Debugger
         To enable it, open IE and go to Tools|'Internet Options'|Advanced and uncheck
        "Disable Script Debugging (Internet Explorer)".
     If the debugger cannot debug any script code in the application you are
     trying to debug, delete or rename
     the HKLM\Software\Microsoft\Ole\DefaultAccessPermission key.
    -->
</head>

<body>

<h2>Test Component Object Model (COM) Container</h2>

<h3>Test FileSystemObject Object</h3>
<dl><dt>My Computer</dt>
<script language="JavaScript" type="text/javascript">
if (typeof ActiveXObject != 'undefined')
  {
  var fsObj      = new ActiveXObject("Scripting.FileSystemObject");
  if (fsObj != undefined)
    {
    var enumDrives = new Enumerator(fsObj.Drives);
    var strList = "";
    do
      {
      var eItem = enumDrives.item();
      strList = strList + "<dd>" + eItem.DriveLetter + ": ";
      if(eItem.DriveType == 3)
        strList += eItem.ShareName;
      else if(eItem.IsReady)
        strList += eItem.VolumeName;
      else
        strList += "device is not ready";
      strList += "</dd>\n";
      enumDrives.moveNext();
      } while(!enumDrives.atEnd());
    document.write(strList);
    }
  }
</script>
</dl>

<script language="JavaScript" type="text/javascript">
  var strCoClass = "TestAtl7Web";
  document.writeln("<h3>Test " + strCoClass +" Object</h3>");
</script>

<dl>
  <script language="JavaScript" type="text/javascript">
  var strClsId = "unknown";
  var strProgId = "unknown";
  if (typeof ActiveXObject != 'undefined')
    {
    //coclass physical name (uuid) from the .idl file
    strClsId = "22252C96-126D-4147-A963-C38BC7E1E644";
    //Program ID is coclass logical name
    strProgId = "TestComAtlNet." + strCoClass;
    }
  else
    document.writeln("<dd>The object could not be tested!</dd>");
  </script>
  <dt>COM Class ID</dt>
  <dd>
    <script language="JavaScript" type="text/javascript">
      document.writeln(strClsId+'<br />');
      document.writeln('HKEY_CLASSES_ROOT\\CLSID\\{' + strClsId + '}');
    </script>
  </dd>
  <dt>Program ID</dt>
  <dd>
    <script language="JavaScript" type="text/javascript">
      document.writeln('HKEY_CLASSES_ROOT\\CLSID\\{' + strClsId + '}\\ProgID<br />');
      document.writeln(strProgId);
    </script>
  </dd>

  <dd>
    <script language="JavaScript" type="text/javascript">
    debugger;
    if (typeof ActiveXObject != 'undefined')
      {
      var testObj = new ActiveXObject(strProgId);
      if (testObj != null)
        {
        try
          {
          if (testObj.TestMethod != null)
            {
            var strResult = "7 + 2 = ";
            strResult += testObj.TestMethod(7);
            document.write(strResult);
            }
          else
            document.writeln("undefined method");
          }
        catch(err)
          {
          if (err.description == "")
            err.description = "Inaccessible object: " + strProgId;
          document.writeln(err.name + "(" + 
                err.number + ")<br />" + err.description );
          }
        }
      else
        document.write("undefined");
      }
    </script>
  </dd>
</dl>

<!-- test as embedded Object
//<object classid="clsid:8CFF83A5-6A5F-4AE7-BDB5-45E8532AC543" id="TestComAtlNet.TestAtl7Obj.1" width="130" height="123" VIEWASTEXT>
//  <param name="TestMethod" value="7">
//</object>
-->

<hr />
<script language="JavaScript" type="text/javascript">
  document.write("<img src='../../../../../../Doc/Res/S/icoJavaScript.gif' alt='JavaScript' border='0'>");
  if (typeof ActiveXObject == 'undefined')
    document.write(" <b style='color:red'>Browser does not support ActiveX.</b>");
</script>
<noscript><p style="color:red">JavaScript seems to be disabled!</p></noscript>

</body>

</html>
