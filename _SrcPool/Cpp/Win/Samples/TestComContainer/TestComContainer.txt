$RCSfile: TestComContainer.txt$: developer's note
$Revision: 2$ $Date: 2007-03-02 20:21:54$
$Author: Darko Kolakovic$

Samples and test suites for the Component Object Model (COM), Active Template Library (ATL), Client in JavaScript and Microsoft Windows API.

Copyright: CommonSoft Inc.
1998-02-01 Darko Kolakovic

If you want to create an instance of COM object manually, without using CComObject
wrapper, you have to  provide IUnknown implementation. This is one way how to
accomplish it:

    class CTestAtlObj :   public ITestAtlObj, ...
    {
    ...
    };
    ...
    CComObject<CTestAtlObj>* pTestAtlObj = NULL;
    HRESULT hr = CComObject<CTestAtlObj>::CreateInstance(&pTestAtlObj);
    if (SUCCEEDED(hr))
      //Note: the new instance has refcount of zero, so it have to be incremented
      pTestAtlObj->AddRef();

JavaScript Notes:
-----------------
Requirements: HTML browser supporting ActiveX

Visual C/C++ 6.0 Notes
----------------------
Include directory <Test COM>\idl\ with MIDL generated files in order to create the container.
Also <Test COM>.dll have to be registered:
  regsvr32 <Test COM>.dll

\	TestComContainer.dsp	Microsoft Developer Studio Project (DSP) file is a generated build file, format version 6.00 (MSVC6).	Win32
\	TestComContainer.vcproj Microsoft Developer Studio .Net Project (VcProj) file is a generated build file, format version 8.0 (MSVC8 2005).	Win32
\	TestComContainer7.vcproj Microsoft Developer Studio .Net Project (VcProj) file is a generated build file, format version 7.10 (MSVC7 2003).	Win32

Microsoft Visual Studio C++ 2005 v8.0
======================================
Compiler Warning C4996 in release build using ATL/WTL
-----------------------------------------------------
C4996 can also occur if you use MFC or ATL functions that were deprecated for security reasons.
Excerpt from <atlapp.h>
#if _SECURE_ATL && !defined(_ATL_MIN_CRT) && !defined(_WIN32_WCE)
  //MSVC++ v8.0 Use secure version string handlers
#else
  //Use deprecated unsecured versions of string handlers
  //Compiler Warning (level 3) C4996 will be issued
  //See also: MSDN, Safe Libraries: Standard C++ Library, http://msdn.microsoft.com/en-us/library/aa985872.aspx;
  //MSDN, Security Enhancements in the CRT, http://msdn.microsoft.com/en-us/library/8ef0s5kh.aspx
  #pragma warning(disable : 4996)
#endif

To solve the issue, don't use ATL with minimized CRT library, while compiling the application.
Change project configuration as follows:
  Project Property Page | Configuration Properties | General | Minimize CRT Use in ATL : No

Microsoft Visual Studio C++ 2008 v9.0
======================================
- Web deployment to the local IIS server is no longer supported. The Web Deployment build tool has been removed from your project settings. 
- ActiveX references no longer support per-configuration settings. To generate a custom interop wrapper, use tlbimp/aximp to generate the interop assembly and add it as an assembly reference. 
- This application has been updated to include settings related to the User Account Control (UAC) feature of Windows Vista. By default, when run on Windows Vista with UAC enabled, this application is marked to run with the same privileges as the process that launched it. This marking also disables the application from running with virtualization. You can change UAC related settings from the Property Pages of the project. 
